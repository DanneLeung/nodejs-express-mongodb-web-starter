//
   Created by danne on 2015/10/29.
extends ./layout
block header
  link( rel="stylesheet" href="//cdn.bootcss.com/datatables/1.10.11/css/dataTables.bootstrap.min.css")
//应用的page title
block pageTitle
  if viewType == 'add'
    h1 供应商联系人新增
      small 添加供应商联系人信息
  if viewType == 'edit'
    h1 供应商联系人编辑
      small 编辑供应商联系人信息
  if viewType == 'view'
    h1 供应商联系人查看
      small 查看供应商联系人信息

block main
  .panel
    .panel-heading.with-border
      if viewType == 'add'
        h3.panel-title 添加供应商联系人信息
      if viewType == 'edit'
        h3.panel-title 编辑供应商联系人信息
      if viewType == 'view'
        h3.panel-title 查看供应商联系人信息

      .panel-tools
        a.btn.btn-box-tool.btn-default(href='/shop/supplier/contactList/#{s_contact.supplier}')
          i.fa.fa-reply
          span  返回
        | &nbsp;
        if viewType == 'add' || viewType == 'edit'
          button#save.btn.btn-box-tool.btn-default
            i.fa.fa-save
            span  保存
        | &nbsp;
        if viewType == 'view' || viewType == 'edit'
          button#del.btn.btn-box-tool.btn-default.del
            i.fa.fa-trash
            span  删除
      //&nbsp;
      //button.btn.btn-box-tool(data-widget="collapse")
      //  i.fa.fa-minus
    .panel-body
      div#roleEdit.row
        .col-md-12
          if viewType == 'edit'
            form#typeDelForm(method='post', style='display:none', action='/shop/supplier/contact_del')
              input#ids(type='hidden',name='ids',value="#{s_contact._id}")
              input#supplier(type='hidden',name='supplier',value="#{s_contact.supplier}")
              input#_csrf(type='hidden', name='_csrf', value=_csrf)

          form#contactForm.form-horizontal(name='contactForm', action='/shop/supplier/contact_save', method='post')
            if viewType == 'edit'
              input#id(type='hidden', name='id', value="#{s_contact._id}")

            input#_csrf(type='hidden', name='_csrf', value=_csrf)
            input#type(type='hidden', name='type', value="2")
            input#supplier(type='hidden',name='supplier',value="#{s_contact.supplier}")

            .form-group
              label.control-label.col-md-3.required 联系人：
              .controls.col-md-9
                input#name.form-control(type="text" name="name" placeholder='请输入联系人名称' value="#{s_contact != null ? s_contact.name : ''}")

            .form-group
              label.control-label.col-md-3.required 联系方式：
              .controls.col-md-9
                input#tel.form-control(type="text" name="tel" placeholder='请输入手机号' value="#{s_contact != null ? s_contact.tel : ''}")
            .form-group
              label.control-label.col-md-3.required 职称：
              .controls.col-md-9
                input#title.form-control(type="text" name="title" placeholder='请输入职称名称' value="#{s_contact != null ? s_contact.title : ''}")
            .form-group
              label.control-label.col-md-3.required 邮箱：
              .controls.col-md-9
                input#email.form-control(type="email" name="email" placeholder='请输入邮箱地址' value="#{s_contact != null ? s_contact.email : ''}")
            .form-group
              label.control-label.col-md-3 备注：
                span.required
              .controls.col-md-9
                textarea#note.form-control(type="text" name="note" placeholder='请输入备注信息' rows='3')
                  | #{s_contact != null ? s_contact.note : ''}


//应用添加的脚本在scripts block中定义
block scripts
  script.
    $(document).ready(function () {
      var form = $('#contactForm');
      $("#save").on('click', function () {
        form.submit();
      });
      form.validate({
        rules: {
          name: {
            required: true
          },tel: {
            required: true,
            mobileCN:true
          },title: {
            required: true
          },email: {
            required: true,
            emailCN:true
          },note: {
            required: true
          }
        },
        messages: {
          name: {
            remote: '该角色已存在!'
          }
        }
      });

      $('#del').on('click', function () {
        bootbox.confirm("确定要删除数据吗?", function (result) {
          if (result) {
            $("#typeDelForm").submit();
          }
        });
      });

    });
