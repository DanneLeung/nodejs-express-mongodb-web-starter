//
   Created by danne on 2015/10/24.
extends ../../layouts/default
block header
  link( rel="stylesheet" href="//cdn.bootcss.com/datatables/1.10.11/css/dataTables.bootstrap.min.css")

//应用的page title
block pageTitle
  h1 网点所属的用户
    small 查看用户信息
block main
  .panel
    .panel-heading.with-border
      h3.panel-title 用户信息
      .panel-tools
        a.btn.btn-sm.btn-default(href="/channel/branch/list" title="返回网点")
          i.fa.fa-reply
    .panel-body
      #tableWrapper(style="display:none;")
        table#userByBranchList.table.table-bordered.table-hover.table-striped
          thead
            th 用户名
            th 姓名
            th 手机
            th 邮箱
            th 网点
            th 职位
            th 分组
          tbody

//应用添加的脚本在scripts block中定义
block scripts
  script(src='//cdn.bootcss.com/datatables/1.10.11/js/jquery.dataTables.min.js')
  script(src='//cdn.bootcss.com/datatables/1.10.11/js/dataTables.bootstrap.min.js')
  script.
    $(function () {

      var opts = {
        "language": {
          "url": "/themes/default/plugins/datatables/Chinese.json"
        },
        autoWidth: false,
        lengthChange: true,
        searching: true,
        processing: false,
        serverSide: true,
        deferRender: true
      };
      var t = $('#userByBranchList').DataTable($.extend(opts, {
                ajax: {url: '/system/user/userDatatable/#{branchId}'},
                order: [[0, 'asc']],
                columnDefs: [
                  //{targets: 0, visible: true, sortable: false, searchable: false, defaultContent: ''},

                ],
                columns: [
                  {data: "username", defaultContent: ''},
                  {data: "fullname", defaultContent: ''},
                  {data: "mobile", defaultContent: ''},
                  {data: "email", defaultContent: ''},
                  {data: "branch.name", defaultContent: ''},
                  {data: "place", defaultContent: ''},
                  {data: "group.name", defaultContent: ''}
                ]
              }
      ));
    }).on('draw.dt', function () {
      $("#tableWrapper").fadeIn();
    });;