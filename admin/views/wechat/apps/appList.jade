//
  Created by yu869 on 2015/10/26.

extends ../../layouts/default
block header
block pageTitle
  h1 微信公众号应用模块管理
block main
  .panel
    .panel-heading
      h3.panel-title 微信应用模块列表
    .panel-body
      #tableWrapper
        table#wechatFansList.table.table-hover.table-striped
          thead
            th 分类
            th Logo
            th 名称
            th URL
            th 说明
            th.text-center 应用
          tbody
            each a in apps
              tr
                td=a.type
                td
                  img(width=50 height=50 src='#{a.logo}')
                td=a.name
                td=a.url
                td=a.description
                td.text-center
                  button.btn.btn-xs.btn-default.addAppToWechat(title='在该公众号打开应用' data-id = '#{a._id}')
                    i.fa.fa-toggle-on

                  

//应用添加的脚本在scripts block中定义
block scripts
  script.
    $(document).ready(function () {
      $(".addAppToWechat").on('click',function(){
        var id = $(this).data("id");
        add(id);
      });

    });
    function add(id){
      $.ajax({
        url:'/wechat/apps/addAppToWechat/' + id,
        method: "get",
        data: {},
        success: function (data) {
          bootbox.alert(data);
        }
      });
    }
