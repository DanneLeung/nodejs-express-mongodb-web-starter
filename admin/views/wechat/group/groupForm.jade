//
   Created by danne on 2015/10/29.
extends ../../layouts/default
block header
//应用的page title
block pageTitle
  if type == "01"
    if group.isNew
      h1 微信粉丝分组信息新增
        small 添加微信粉丝分组信息
    if !group.isNew
      h1 微信粉丝分组信息编辑
        small 编辑微信粉丝分组信息
    if viewType == 'view'
      h1 微信粉丝分组信息查看
        small 查看微信粉丝分组信息
  if type == "02"
    if group.isNew
      h1 会员分组信息新增
        small 添加会员分组信息
    if !group.isNew
      h1 会员分组信息编辑
        small 编辑会员分组信息
    if viewType == 'view'
      h1 会员分组信息查看
        small 查看会员分组信息

block main
  .panel
    .panel-heading.with-border
      if type == "01"
        if group.isNew
          h3.panel-title 添加微信粉丝分组信息
        if !group.isNew
          h3.panel-title 编辑微信粉丝分组信息
        if viewType == 'view'
          h3.panel-title 查看微信粉丝分组信息
      if type == "02"
        if group.isNew
          h3.panel-title 添加会员分组信息
        if !group.isNew
          h3.panel-title 编辑会员分组信息
        if viewType == 'view'
          h3.panel-title 查看会员分组信息

      .panel-tools
        a.btn.btn-box-tool.btn-default(href='/member/group/list/#{type}')
          i.fa.fa-reply
          span  返回
        | &nbsp;
        if group.isNew || !group.isNew
          button#save.btn.btn-box-tool.btn-default
            i.fa.fa-save
            span  保存
        | &nbsp;
      //button.btn.btn-box-tool(data-widget="collapse")
      //  i.fa.fa-caret-left
    .panel-body
      div#userEdit.row
        .col-md-12

          form#groupForm.form-horizontal(name='groupForm', action='/member/group/save/#{type}', method='post')
            if !group.isNew
              input#id(type='hidden', name='id', value="#{group._id}")

            input#_csrf(type='hidden', name='_csrf', value=_csrf)
            .form-group
              label.control-label.col-md-3 分组名称：

              .controls.col-md-9
                input#name.form-control.required(name='name',placeholder='名称', value="#{group ? group.name : ''}")
            .form-group
              label.control-label.col-md-3 描述：

              .controls.col-md-9
                textarea#Desc.form-control(name='description',rows="3", placeholder='分组的描述')
                  | #{group ? group.description : ''}


//应用添加的脚本在scripts block中定义
block scripts
  script.
    $(document).ready(function () {

      $('input').iCheck({
        checkboxClass: 'icheckbox_square-blue',
        radioClass: 'iradio_square-blue',
        increaseArea: '20%' // optional
      });
      var form = $('#groupForm');
      $("#save").on('click', function () {
        form.submit();
      });

      form.validate({
        ignore: '.ignore',
        rules: {
          name: {
            required: true,
            remote: '/member/group/checkname?oldName=#{group ? group.name : ''}'
          },
          Desc: {
            required: true
          }
        },
        messages: {
          name: {
            remote: '分组名称已存在'
          }
        }
      });

      $('#del').on('click', function () {
        bootbox.confirm("确定要删除数据吗?", function (result) {
          if (result) {
            $("#groupDelForm").submit();
          }
        });
      });

    });

